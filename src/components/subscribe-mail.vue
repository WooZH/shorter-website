<template>
  <div class="subscribe-input-group" :class="{ 'subscribe-dialog': type }">
    <input
      class="subscribe-input"
      v-model="mail"
      type="text"
      placeholder="Your E-mail"
      :class="[{ 'valid-fail': warn_tip }]"
      @keyup.enter="submit"
    />
    <div v-if="type" class="valid-fail-text" v-show="warn_tip">
      <span>{{ warn_text }}</span>
    </div>
    <button
      class="btn btn-primary subscribe-btn"
      @click="submit"
      :disabled="loading"
      :class="[{ loading: loading }, { 'failed-style': !isAddressVailed }]"
    >
      <p v-if="dialog">
        <span>Subscribe</span>
      </p>
      <svg
        v-else
        xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink"
        fill="none"
        version="1.1"
        width="28"
        height="28"
        viewBox="0 0 28 28"
      >
        <defs>
          <mask id="master_svg0_2927_4438">
            <g style="mix-blend-mode: passthrough">
              <rect
                x="0"
                y="0"
                width="28"
                height="28"
                rx="0"
                fill="#FFFFFF"
                fill-opacity="1"
              />
            </g>
          </mask>
        </defs>
        <g
          style="mix-blend-mode: passthrough"
          mask="url(#master_svg0_2927_4438)"
        >
          <g style="mix-blend-mode: passthrough">
            <g>
              <path
                d="M13.43955,20.4033L3.9999981057,20.4033Q3.9261297,20.4033,3.853681,20.3889Q3.781232,20.374499999999998,3.712986,20.3462Q3.644741,20.3179,3.5833209999999998,20.276899999999998Q3.521902,20.2359,3.469669,20.1836Q3.417436,20.1314,3.376397,20.07Q3.3353580000000003,20.0086,3.30709,19.9403Q3.278822,19.8721,3.264411,19.799599999999998Q3.25,19.7272,3.25,19.6533L3.25,12.82665L3.25,6Q3.25,5.9261315,3.264411,5.853682Q3.278822,5.781233,3.30709,5.712987Q3.335359,5.644742,3.376398,5.583322Q3.417437,5.521903,3.46967,5.46967Q3.521903,5.417437,3.583322,5.376398Q3.644742,5.335359,3.712987,5.30709Q3.781233,5.278822,3.853682,5.264411Q3.9261315,5.25,4,5.25L13.60238,5.25L23.2048,5.25Q23.2786,5.25,23.3511,5.264411Q23.4235,5.278822,23.4918,5.3070889999999995Q23.56,5.335357,23.6214,5.3763950000000005Q23.6829,5.417434,23.7351,5.469666Q23.7873,5.521898,23.8284,5.583317Q23.8694,5.644735,23.8977,5.71298Q23.9259,5.781225,23.9403,5.853673Q23.9548,5.9261212,23.9548,5.9999890629L23.9549,12.27811Q23.9549,12.351980000000001,23.9404,12.424430000000001Q23.926,12.49688,23.8978,12.56513Q23.8695,12.63337,23.8285,12.694790000000001Q23.7874,12.75621,23.7352,12.80845Q23.683,12.86068,23.6215,12.901720000000001Q23.5601,12.94276,23.4919,12.971029999999999Q23.4236,12.9993,23.3512,13.01371Q23.2787,13.028120000000001,23.2049,13.02813Q23.131,13.02813,23.0585,13.01372Q22.9861,12.999310000000001,22.9178,12.97104Q22.8496,12.94277,22.7882,12.90173Q22.7268,12.8607,22.6745,12.80846Q22.6223,12.75623,22.5813,12.69481Q22.5402,12.63339,22.5119,12.56515Q22.4837,12.4969,22.4693,12.42445Q22.4549,12.352,22.4549,12.27814L22.4548,6.0000109371L23.2048,6L23.2048,6.75L13.60238,6.75L4,6.75L4,6L4.75,6L4.75,12.82665L4.75,19.6533L4,19.6533L4.0000018943,18.9033L13.43956,18.9033Q13.51342,18.9033,13.58587,18.9177Q13.65832,18.9321,13.72657,18.9604Q13.79481,18.9887,13.85623,19.0297Q13.91765,19.0708,13.96989,19.122999999999998Q14.0221,19.1752,14.0632,19.2366Q14.1042,19.298099999999998,14.1325,19.366300000000003Q14.1607,19.4346,14.1751,19.506999999999998Q14.1896,19.5795,14.1896,19.6533Q14.1896,19.7272,14.1751,19.799599999999998Q14.1607,19.8721,14.1325,19.9403Q14.1042,20.0086,14.0632,20.07Q14.0221,20.1314,13.96988,20.1837Q13.91765,20.2359,13.85623,20.276899999999998Q13.79481,20.317999999999998,13.72656,20.3462Q13.65832,20.374499999999998,13.58587,20.3889Q13.51342,20.4033,13.43955,20.4033ZM14.1896,19.6533Q14.1896,19.7272,14.1751,19.799599999999998Q14.1607,19.8721,14.1325,19.9403Q14.1042,20.0086,14.0632,20.07Q14.0221,20.1314,13.96988,20.1836Q13.91765,20.2359,13.85623,20.276899999999998Q13.79481,20.317999999999998,13.72657,20.3462Q13.65832,20.374499999999998,13.58587,20.3889Q13.51342,20.4033,13.43956,20.4033Q13.36569,20.4033,13.29324,20.3889Q13.22079,20.374499999999998,13.15254,20.3462Q13.0843,20.317999999999998,13.02288,20.276899999999998Q12.96146,20.2359,12.90923,20.1836Q12.85699,20.1314,12.81595,20.07Q12.77491,20.0086,12.74665,19.9403Q12.71838,19.8721,12.70397,19.799599999999998Q12.68956,19.7272,12.68956,19.6533Q12.68956,19.5795,12.70397,19.506999999999998Q12.71838,19.4346,12.74665,19.366300000000003Q12.77491,19.298099999999998,12.81595,19.2366Q12.85699,19.1752,12.90923,19.122999999999998Q12.96146,19.0708,13.02288,19.0297Q13.0843,18.9887,13.15254,18.9604Q13.22079,18.9321,13.29324,18.9177Q13.36569,18.9033,13.43956,18.9033Q13.51342,18.9033,13.58587,18.9177Q13.65832,18.9321,13.72657,18.9604Q13.79481,18.9887,13.85623,19.0297Q13.91765,19.0708,13.96988,19.122999999999998Q14.0221,19.1752,14.0632,19.2366Q14.1042,19.298099999999998,14.1325,19.366300000000003Q14.1607,19.4346,14.1751,19.506999999999998Q14.1896,19.5795,14.1896,19.6533ZM23.9549,12.27813Q23.9549,12.35199,23.9404,12.42444Q23.926,12.49689,23.8978,12.56514Q23.8695,12.633379999999999,23.8284,12.6948Q23.7874,12.756219999999999,23.7352,12.80845Q23.6829,12.86069,23.6215,12.90173Q23.5601,12.94277,23.4919,12.971029999999999Q23.4236,12.9993,23.3512,13.01371Q23.2787,13.02813,23.2049,13.02813Q23.131,13.02813,23.0585,13.01371Q22.9861,12.9993,22.9178,12.971029999999999Q22.8496,12.94277,22.7882,12.90173Q22.7268,12.86069,22.6745,12.80845Q22.6223,12.756219999999999,22.5812,12.6948Q22.5402,12.633379999999999,22.5119,12.56514Q22.4837,12.49689,22.4693,12.42444Q22.4549,12.35199,22.4549,12.27813Q22.4549,12.20426,22.4693,12.13181Q22.4837,12.05936,22.5119,11.991109999999999Q22.5402,11.92287,22.5812,11.86145Q22.6223,11.80003,22.6745,11.7478Q22.7268,11.69556,22.7882,11.65452Q22.8496,11.61348,22.9178,11.58522Q22.9861,11.55695,23.0585,11.542539999999999Q23.131,11.52813,23.2049,11.52813Q23.2787,11.52813,23.3512,11.542539999999999Q23.4236,11.55695,23.4919,11.58522Q23.5601,11.61348,23.6215,11.65452Q23.6829,11.69556,23.7352,11.7478Q23.7874,11.80003,23.8284,11.86145Q23.8695,11.92287,23.8978,11.991109999999999Q23.926,12.05936,23.9404,12.13181Q23.9549,12.20426,23.9549,12.27813Z"
                :fill="currentColor"
                fill-opacity="1"
              />
            </g>
            <g style="mix-blend-mode: passthrough">
              <g>
                <ellipse
                  cx="19.94792079925537"
                  cy="17.733463764190674"
                  rx="4.267745018005371"
                  ry="4.266666889190674"
                  fill-opacity="0"
                  stroke-opacity="1"
                  :stroke="currentColor"
                  fill="none"
                  stroke-width="1.5"
                />
              </g>
              <g
                transform="matrix(0.7071961164474487,0.7070174813270569,-0.707196056842804,0.7070174217224121,17.316205047798576,-9.314298700381187)"
              >
                <path
                  d="M19.477925578125,17.773950625L21.398157578125,15.823230625Q21.439617578125,15.781116625,21.488487578125,15.747899625Q21.537367578125,15.714682625,21.591787578125,15.691638625Q21.646197578125,15.668594625,21.704067578125,15.656609625Q21.761937578125,15.644624625,21.821027578125,15.644159625Q21.880117578125,15.643693625000001,21.938167578125,15.654765625Q21.996217578125,15.665837625,22.050987578125,15.688021625Q22.105757578125,15.710205625,22.155157578125,15.742649625Q22.204547578125002,15.775092625,22.246657578125,15.816548625Q22.288777578125,15.858004625,22.321987578125,15.906880625Q22.355207578125,15.955755625,22.378257578125,16.010172625Q22.401297578125,16.064589625,22.413277578125,16.122455625Q22.425267578125002,16.180322725,22.425727578125,16.239415695Q22.426197578125,16.298508725,22.415127578125,16.356556625Q22.404057578125,16.414605625,22.381867578125,16.469378625Q22.359687578125,16.524151625000002,22.327237578125,16.573543625Q22.294797578125,16.622936625,22.253347578125002,16.665050625L20.333109578125,18.615770625Q20.291653578125,18.657880625,20.242777578125,18.691100625Q20.193902578125,18.724320625,20.139485578125,18.747360625Q20.085068578125,18.770400625,20.027202578125,18.782390625Q19.969335478125,18.794370625,19.910242508125,18.794840625Q19.851149478125,18.795300625,19.793101578125,18.784230625Q19.735052578125,18.773160625,19.680279578125,18.750980625Q19.625506578124998,18.728790625,19.576114578125,18.696350625Q19.526721578125,18.663910625,19.484607578125,18.622450625Q19.442493578125,18.580990625,19.409276578125,18.532120625Q19.376059578125002,18.483240625,19.353015578125,18.428830625Q19.329971578125,18.374410625,19.317986578125,18.316540625000002Q19.306001578125,18.258680625,19.305536578125,18.199580625Q19.305070578125,18.140490624999998,19.316142578125,18.082440625Q19.327214578125,18.024390625,19.349398578125,17.969620625Q19.371582578125,17.914850625,19.404026578125,17.865450625Q19.436469578125,17.816060625,19.477925578125,17.773950625ZM20.505517578125,18.194860625Q20.505517578125,18.253950625,20.493988578125,18.311910625Q20.482459578125,18.369870625,20.459845578125,18.424470625Q20.437230578125,18.479060625,20.404399578125,18.528200625Q20.371567578125,18.577340625,20.329781578125,18.619120625Q20.287995578125,18.660910625,20.238859578125002,18.693740625Q20.189724578125,18.726570625,20.135127578125,18.749190625Q20.080531578125,18.771800625,20.022571578125,18.783330625Q19.964612378125,18.794860625,19.905517578125,18.794860625Q19.846422778125,18.794860625,19.788463578125,18.783330625Q19.730503578125,18.771800625,19.675907578125,18.749190625Q19.621310578125,18.726570625,19.572175578124998,18.693740625Q19.523039578125,18.660910625,19.481253578125,18.619120625Q19.439467578125,18.577340625,19.406635578125,18.528200625Q19.373804578125,18.479060625,19.351189578125,18.424470625Q19.328575578125,18.369870625,19.317046578125,18.311910625Q19.305517578125,18.253950625,19.305517578125,18.194860625Q19.305517578125,18.135760625,19.317046578125,18.077800625000002Q19.328575578125,18.019840625,19.351189578125,17.965250625Q19.373804578125,17.910650625,19.406635578125,17.861520625Q19.439467578125,17.812380625,19.481253578125,17.770590625Q19.523039578125,17.728810625,19.572175578124998,17.695980625Q19.621310578125,17.663140625,19.675907578125,17.640530625Q19.730503578125,17.617920625,19.788463578125,17.606390625Q19.846422778125,17.594860625,19.905517578125,17.594860625Q19.964612378125,17.594860625,20.022571578125,17.606390625Q20.080531578125,17.617920625,20.135127578125,17.640530625Q20.189724578125,17.663140625,20.238859578125002,17.695980625Q20.287995578125,17.728810625,20.329781578125,17.770590625Q20.371567578125,17.812380625,20.404399578125,17.861520625Q20.437230578125,17.910650625,20.459845578125,17.965250625Q20.482459578125,18.019840625,20.493988578125,18.077800625000002Q20.505517578125,18.135760625,20.505517578125,18.194860625ZM22.425747578125,16.244140625Q22.425747578125,16.303235425,22.414217578125,16.361194625Q22.402697578125,16.419154625,22.380077578125,16.473750625Q22.357467578125,16.528347625,22.324637578125,16.577482625000002Q22.291797578125,16.626618625,22.250017578125,16.668404625Q22.208227578125,16.710190625,22.159097578125,16.743022625Q22.109957578124998,16.775853625,22.055357578125,16.798468625Q22.000767578125,16.821082625,21.942807578125,16.832611625Q21.884847578125,16.844140625,21.825747578125,16.844140625Q21.766657578125,16.844140625,21.708697578125,16.832611625Q21.650737578125,16.821082625,21.596137578125,16.798468625Q21.541547578125,16.775853625,21.492407578125,16.743022625Q21.443277578125,16.710190625,21.401487578125,16.668404625Q21.359697578125,16.626618625,21.326867578125,16.577482625000002Q21.294037578125,16.528347625,21.271427578125,16.473750625Q21.248807578125,16.419154625,21.237277578125,16.361194625Q21.225747578125,16.303235425,21.225747578125,16.244140625Q21.225747578125,16.185045825,21.237277578125,16.127086625Q21.248807578125,16.069126625,21.271427578125,16.014530625Q21.294037578125,15.959933625,21.326867578125,15.910798625Q21.359697578125,15.861662625,21.401487578125,15.819876625Q21.443277578125,15.778090625,21.492407578125,15.745258625Q21.541547578125,15.712427625,21.596137578125,15.689812625Q21.650737578125,15.667198625,21.708697578125,15.655669625Q21.766657578125,15.644140625,21.825747578125,15.644140625Q21.884847578125,15.644140625,21.942807578125,15.655669625Q22.000767578125,15.667198625,22.055357578125,15.689812625Q22.109957578124998,15.712427625,22.159097578125,15.745258625Q22.208227578125,15.778090625,22.250017578125,15.819876625Q22.291797578125,15.861662625,22.324637578125,15.910798625Q22.357467578125,15.959933625,22.380077578125,16.014530625Q22.402697578125,16.069126625,22.414217578125,16.127086625Q22.425747578125,16.185045825,22.425747578125,16.244140625Z"
                  :fill="currentColor"
                  fill-opacity="1"
                />
              </g>
              <g
                transform="matrix(-0.7071961164474487,0.7070174813270569,-0.707196056842804,-0.7070174217224121,48.76379051004187,15.049232918318012)"
              >
                <path
                  d="M20.835835734375,19.152856875L22.756067734375,17.202136875Q22.797527734375,17.160022875,22.846397734375,17.126805875Q22.895277734375,17.093588875000002,22.949697734375,17.070544875Q23.004107734375,17.047500875,23.061977734375,17.035515875Q23.119847734375,17.023530875,23.178937734375,17.023065875Q23.238027734375,17.022599875,23.296077734375,17.033671875Q23.354127734375,17.044743875,23.408897734375,17.066927875Q23.463667734375,17.089111875,23.513067734375,17.121555875Q23.562457734375002,17.153998875,23.604567734375,17.195454875Q23.646687734375,17.236910875,23.679897734375,17.285786875Q23.713117734375,17.334661875,23.736167734375,17.389078875Q23.759207734375,17.443495875,23.771187734375,17.501361875Q23.783177734375002,17.559228975,23.783637734375,17.618321945Q23.784107734375,17.677414975,23.773037734375,17.735462875Q23.761967734375,17.793511875,23.739777734375,17.848284875Q23.717597734375,17.903057875000002,23.685147734375,17.952449875Q23.652707734375,18.001842875,23.611257734375002,18.043956875L21.691019734375,19.994676875Q21.649563734375,20.036786875,21.600687734375,20.070006875Q21.551812734375,20.103226875,21.497395734375,20.126266875Q21.442978734375,20.149306875,21.385112734375,20.161296875Q21.327245634375,20.173276875,21.268152664375,20.173746875Q21.209059634375,20.174206875,21.151011734375,20.163136875Q21.092962734375,20.152066875,21.038189734375,20.129886875Q20.983416734374998,20.107696875,20.934024734375,20.075256875Q20.884631734375,20.042816875,20.842517734375,20.001356875Q20.800403734375,19.959896875,20.767186734375,19.911026875Q20.733969734375002,19.862146875,20.710925734375,19.807736875Q20.687881734375,19.753316875,20.675896734375,19.695446875000002Q20.663911734375,19.637586875,20.663446734375,19.578486875Q20.662980734375,19.519396874999998,20.674052734375,19.461346875Q20.685124734375,19.403296875,20.707308734375,19.348526875Q20.729492734375,19.293756875,20.761936734375,19.244356875Q20.794379734375,19.194966875,20.835835734375,19.152856875ZM21.863427734375,19.573766875Q21.863427734375,19.632856875,21.851898734375,19.690816875Q21.840369734375,19.748776875,21.817755734375,19.803376875Q21.795140734375,19.857966875,21.762309734375,19.907106875Q21.729477734375,19.956246875,21.687691734375,19.998026875Q21.645905734375,20.039816875,21.596769734375002,20.072646875Q21.547634734375,20.105476875,21.493037734375,20.128096875Q21.438441734375,20.150706875,21.380481734375,20.162236875Q21.322522534375,20.173766875,21.263427734375,20.173766875Q21.204332934375,20.173766875,21.146373734375,20.162236875Q21.088413734375,20.150706875,21.033817734375,20.128096875Q20.979220734375,20.105476875,20.930085734374998,20.072646875Q20.880949734375,20.039816875,20.839163734375,19.998026875Q20.797377734375,19.956246875,20.764545734375,19.907106875Q20.731714734375,19.857966875,20.709099734375,19.803376875Q20.686485734375,19.748776875,20.674956734375,19.690816875Q20.663427734375,19.632856875,20.663427734375,19.573766875Q20.663427734375,19.514666875,20.674956734375,19.456706875000002Q20.686485734375,19.398746875,20.709099734375,19.344156875Q20.731714734375,19.289556875,20.764545734375,19.240426875Q20.797377734375,19.191286875,20.839163734375,19.149496875Q20.880949734375,19.107716875,20.930085734374998,19.074886875Q20.979220734375,19.042046875,21.033817734375,19.019436875Q21.088413734375,18.996826875,21.146373734375,18.985296875Q21.204332934375,18.973766875,21.263427734375,18.973766875Q21.322522534375,18.973766875,21.380481734375,18.985296875Q21.438441734375,18.996826875,21.493037734375,19.019436875Q21.547634734375,19.042046875,21.596769734375002,19.074886875Q21.645905734375,19.107716875,21.687691734375,19.149496875Q21.729477734375,19.191286875,21.762309734375,19.240426875Q21.795140734375,19.289556875,21.817755734375,19.344156875Q21.840369734375,19.398746875,21.851898734375,19.456706875000002Q21.863427734375,19.514666875,21.863427734375,19.573766875ZM23.783657734375,17.623046875Q23.783657734375,17.682141675,23.772127734375,17.740100875Q23.760607734375,17.798060875,23.737987734375,17.852656875Q23.715377734375,17.907253875,23.682547734375,17.956388875000002Q23.649707734375,18.005524875,23.607927734375,18.047310875Q23.566137734375,18.089096875,23.517007734375,18.121928875Q23.467867734374998,18.154759875,23.413267734375,18.177374875Q23.358677734375,18.199988875,23.300717734375,18.211517875Q23.242757734375,18.223046875,23.183657734375,18.223046875Q23.124567734375,18.223046875,23.066607734375,18.211517875Q23.008647734375,18.199988875,22.954047734375,18.177374875Q22.899457734375,18.154759875,22.850317734375,18.121928875Q22.801187734375,18.089096875,22.759397734375,18.047310875Q22.717607734375,18.005524875,22.684777734375,17.956388875000002Q22.651947734375,17.907253875,22.629337734375,17.852656875Q22.606717734375,17.798060875,22.595187734375,17.740100875Q22.583657734375,17.682141675,22.583657734375,17.623046875Q22.583657734375,17.563952075,22.595187734375,17.505992875Q22.606717734375,17.448032875,22.629337734375,17.393436875Q22.651947734375,17.338839875,22.684777734375,17.289704874999998Q22.717607734375,17.240568875,22.759397734375,17.198782875Q22.801187734375,17.156996875,22.850317734375,17.124164875Q22.899457734375,17.091333875,22.954047734375,17.068718875Q23.008647734375,17.046104875,23.066607734375,17.034575875Q23.124567734375,17.023046875,23.183657734375,17.023046875Q23.242757734375,17.023046875,23.300717734375,17.034575875Q23.358677734375,17.046104875,23.413267734375,17.068718875Q23.467867734374998,17.091333875,23.517007734375,17.124164875Q23.566137734375,17.156996875,23.607927734375,17.198782875Q23.649707734375,17.240568875,23.682547734375,17.289704874999998Q23.715377734375,17.338839875,23.737987734375,17.393436875Q23.760607734375,17.448032875,23.772127734375,17.505992875Q23.783657734375,17.563952075,23.783657734375,17.623046875Z"
                  :fill="currentColor"
                  fill-opacity="1"
                />
              </g>
            </g>
            <g>
              <path
                d="M23.618,6.625913L14.0156,12.96494Q13.92362,13.025649999999999,13.81809,13.05734Q13.71256,13.089030000000001,13.60238,13.089030000000001Q13.49219,13.089030000000001,13.38667,13.05734Q13.28114,13.025649999999999,13.18918,12.96494L3.586802,6.625913Q3.525155,6.585217,3.472632,6.533276Q3.420109,6.481334,3.3787279999999997,6.420144Q3.337348,6.358954,3.3087,6.290867Q3.280052,6.22278,3.265237,6.150412Q3.250423,6.0780446,3.250012,6.00417722Q3.2496,5.9303098,3.263608,5.857781Q3.277615,5.785253,3.305503,5.716851Q3.33339,5.648449,3.374087,5.586802Q3.414783,5.525155,3.466724,5.472632Q3.518666,5.420109,3.579856,5.378728Q3.6410460000000002,5.337348,3.709133,5.3087Q3.77722,5.2800519999999995,3.849588,5.265237Q3.9219554,5.250423,3.99582278,5.250012Q4.0696902,5.2496,4.142219,5.263608Q4.214747,5.277615,4.283149,5.305503Q4.351551,5.33339,4.413198,5.374087L14.0156,11.71312L13.60238,12.339030000000001L13.18918,11.71312L22.7916,5.374087Q22.8532,5.33339,22.9216,5.305503Q22.99,5.277615,23.0625,5.263608Q23.1351,5.2496,23.2089,5.250012Q23.2828,5.250423,23.3552,5.265237Q23.4275,5.2800519999999995,23.4956,5.3087Q23.5637,5.337348,23.6249,5.378728Q23.6861,5.420109,23.738,5.472632Q23.79,5.525155,23.8307,5.586802Q23.8714,5.648449,23.8993,5.716851Q23.9271,5.785253,23.9412,5.857782Q23.9552,5.9303099,23.9547,6.00417729Q23.9543,6.0780447,23.9395,6.150412Q23.9247,6.22278,23.8961,6.290867Q23.8674,6.358955,23.826,6.420144Q23.7846,6.481334,23.7321,6.533276Q23.6796,6.585217,23.618,6.625913ZM23.9548,6Q23.9548,6.0738685,23.9403,6.146318Q23.9259,6.218767,23.8977,6.287013Q23.8694,6.355258,23.8284,6.416678Q23.7873,6.478097,23.7351,6.53033Q23.6829,6.582563,23.6214,6.623602Q23.56,6.664641,23.4918,6.69291Q23.4235,6.721178,23.3511,6.735589Q23.2786,6.75,23.2048,6.75Q23.1309,6.75,23.0584,6.735589Q22.986,6.721178,22.9177,6.69291Q22.8495,6.664641,22.7881,6.623602Q22.7267,6.582563,22.6744,6.53033Q22.6222,6.478097,22.5812,6.416678Q22.5401,6.355258,22.5118,6.287013Q22.4836,6.218767,22.4692,6.146318Q22.4548,6.0738685,22.4548,6Q22.4548,5.9261315,22.4692,5.853682Q22.4836,5.781233,22.5118,5.712987Q22.5401,5.644742,22.5812,5.583322Q22.6222,5.521903,22.6744,5.46967Q22.7267,5.417437,22.7881,5.376398Q22.8495,5.335359,22.9177,5.30709Q22.986,5.278822,23.0584,5.264411Q23.1309,5.25,23.2048,5.25Q23.2786,5.25,23.3511,5.264411Q23.4235,5.278822,23.4918,5.30709Q23.56,5.335359,23.6214,5.376398Q23.6829,5.417437,23.7351,5.46967Q23.7873,5.521903,23.8284,5.583322Q23.8694,5.644742,23.8977,5.712987Q23.9259,5.781233,23.9403,5.853682Q23.9548,5.9261315,23.9548,6ZM4.75,6Q4.75,6.0738685,4.735589,6.146318Q4.721178,6.218767,4.69291,6.287013Q4.664641,6.355258,4.623602,6.416678Q4.582563,6.478097,4.53033,6.53033Q4.478097,6.582563,4.416678,6.623602Q4.355258,6.664641,4.287013,6.69291Q4.218767,6.721178,4.146318,6.735589Q4.0738685,6.75,4,6.75Q3.9261315,6.75,3.853682,6.735589Q3.781233,6.721178,3.712987,6.69291Q3.644742,6.664641,3.583322,6.623602Q3.521903,6.582563,3.46967,6.53033Q3.417437,6.478097,3.376398,6.416678Q3.335359,6.355258,3.30709,6.287013Q3.278822,6.218767,3.264411,6.146318Q3.25,6.0738685,3.25,6Q3.25,5.9261315,3.264411,5.853682Q3.278822,5.781233,3.30709,5.712987Q3.335359,5.644742,3.376398,5.583322Q3.417437,5.521903,3.46967,5.46967Q3.521903,5.417437,3.583322,5.376398Q3.644742,5.335359,3.712987,5.30709Q3.781233,5.278822,3.853682,5.264411Q3.9261315,5.25,4,5.25Q4.0738685,5.25,4.146318,5.264411Q4.218767,5.278822,4.287013,5.30709Q4.355258,5.335359,4.416678,5.376398Q4.478097,5.417437,4.53033,5.46967Q4.582563,5.521903,4.623602,5.583322Q4.664641,5.644742,4.69291,5.712987Q4.721178,5.781233,4.735589,5.853682Q4.75,5.9261315,4.75,6Z"
                :fill="currentColor"
                fill-opacity="1"
              />
            </g>
          </g>
        </g>
      </svg>
    </button>
  </div>
  <div v-if="!type" class="valid-fail-text" v-show="warn_tip">
    <span>
      {{ warn_text }}
    </span>
  </div>
</template>
<script setup>
import { computed } from "@vue/reactivity";
import { ref, watch } from "vue";

defineProps({
  type: {
    type: Boolean,
    default: false,
  },
  dialog: {
    type: Boolean,
    default: false,
  },
});
const loading = ref(false);
const emit = defineEmits(["success", "fail"]);

const mail = ref("");
const warn_text = ref("");
const warn_tip = ref(false);
watch(
  () => mail.value,
  (oldValue, newValue) => {
    if (oldValue !== newValue) {
      warn_tip.value = false;
    }
  }
);
// subscribe
const currentColor = computed(() => {
  if (isAddressVailed.value) {
    return "#FFFFFF";
  } else {
    return "#C0C4CC";
  }
});
const isAddressVailed = computed(() => {
  const reg =
    /[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/;
  if (!mail.value) {
    return false;
  } else {
    if (reg.test(mail.value)) {
      return true;
    } else {
      return false;
    }
  }
});

const API_KEY = "tzxxlbbcCiqjpt4OGVOCL3YdIm4Yb2yU";
function submit() {
  const reg =
    /[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/;
  if (!mail.value) {
    warn_text.value = "Please type in your email address";
  } else {
    warn_text.value = "Invalid email address";
  }

  if (reg.test(mail.value)) {
    warn_tip.value = false;
    loading.value = true;
    let formData = [];
    const data = {
      email: mail.value,
      first_name: "",
      last_name: "",
      double_opt_in: true,
    };

    for (const name in data) {
      var encodedKey = encodeURIComponent(name);
      var encodedValue = encodeURIComponent(data[name]);
      formData.push(encodedKey + "=" + encodedValue);
    }
    formData = formData.join("&");
    const url = "https://subscribe.shorter.finance/proxy/v2/subscribers";
    subscribe(url, formData)
      .then((res) => {
        if (res.email) {
          // subscribe success
          emit("success", mail.value);
          mail.value = "";
        } else {
          const default_error_text =
            "Something went wrong, please try again later";
          warn_tip.value = true;
          warn_text.value = res.error.email[0] || default_error_text;
          emit("fail", mail.value);
        }
        loading.value = false;
      })
      .catch((error) => {
        const default_error_text =
          "Something went wrong, please try again later";
        warn_tip.value = true;
        warn_text.value = error.email || default_error_text;
        loading.value = false;
        emit("fail", mail.value);
      });
  } else {
    warn_tip.value = true;
    loading.value = false;
    cancelWarnTip();
  }
}
function cancelWarnTip() {
  setTimeout(() => {
    warn_tip.value = false;
  }, 3000);
}

async function subscribe(url = "", formData) {
  const response = await fetch(url, {
    method: "POST",
    headers: new Headers({
      Authorization: `Bearer ${API_KEY}`,
      "Content-Type": "application/x-www-form-urlencoded",
    }),
    mode: "cors",
    body: formData,
  });
  return response.json();
}
</script>
<style lang="scss" scoped>
@use "../assets/base.scss" as base;
@import "../assets/base.scss";

.subscribe-input-group {
  margin-top: 48px;
  @include base.flexVerticalCenter;

  .subscribe-input {
    font-size: 16px;
    line-height: 48px;
    @include base.trans;
    background-color: $defaultWhiteColor;
    color: $fontColor;
    width: 430px;
    height: 48px;
    border: $defaultSolidBorder;
    padding: 0 24px;
    padding-right: 68px;
    border-radius: $btnRadius;
    // border-right: 0;
    &::placeholder {
      font-size: 14px;
      line-height: 20px;
      color: #c0c4cc;
    }
    &:focus,
    &:hover {
      border-color: $primaryColor;
      background-color: white;
    }
  }
  .subscribe-btn {
    transform: translateX(-68px);
    border-radius: 0 $btnRadius $btnRadius 0;
    border-color: transparent;
    width: 68px;
    height: 48px;
    font-size: 16px;
  }
}
.subscribe-input-group {
  .valid-fail {
    border-color: #ff6461;
    background-color: #fdf3f3;
  }
  .failed-style {
    border-color: transparent;
    border-left-width: 0;
    background-color: transparent;
    color: $fontColor;
    cursor: not-allowed;
    pointer-events: none;
  }
}
.valid-fail-text {
  color: rgba(#ff6461, 1);
  margin-top: 8px;
  font-size: 16px;
  line-height: 24px;
  position: absolute;
  display: flex;
  @include base.flexVerticalCenter;
}
.valid-fail-icon {
  margin-right: 4px;
}

// for dialog
.subscribe-dialog {
  position: relative;
  flex-direction: column;
  margin-top: 16px;
  align-items: flex-start;
  .valid-fail-text {
    position: relative;
  }
  .subscribe-input {
    width: 100%;
    height: 56px;
    border-radius: $btnRadius;
    border: $defaultSolidBorder;
  }
  .subscribe-btn {
    transform: translateX(0);
    width: 100%;
    height: 56px;
    margin-top: 32px;
    border-radius: $btnRadius;
    border-left-width: 0;
    &:hover {
      transform: translateY(-1px) translateX(0);
    }
  }
  .valid-fail-text {
    margin-bottom: -18px;
  }
}
.text-loading {
  @include base.trans;
  width: 0;
  opacity: 0;
}
.text-default {
  @include base.trans;
}
.loading {
  display: flex;
  @include base.trans;
  @include base.flexCenter;

  background-color: rgba($primaryColor, 0.8);
  cursor: not-allowed;
  pointer-events: none;
  .text-loading {
    width: 16px;
    opacity: 1;
    transform: translateX(14px);
    transform-origin: left center;
  }
}

.circle {
  display: inline-block;
  width: 16px;
  height: 16px;
  border: $defaultSolidBorder;
  border-color: $defaultWhiteColor;
  border-right-color: transparent;
  border-width: 2px;
  animation: round 1s infinite;
  @include base.round;
}

@keyframes round {
  from {
    transform: rotate(0);
  }
  to {
    transform: rotate(360deg);
  }
}

@media screen and (max-width: 750px) {
  .subscribe-input-group {
    display: block;
    position: relative;
    margin-top: 24px;
    .btn {
      position: absolute;
      right: 0px;
      top: 0;
      transform: translateX(0);
    }
    .subscribe-input {
      width: 100%;
    }
  }
  .valid-fail-text {
    position: relative;
  }
}
</style>
